m4_define([AT_PACKAGE_STRING],[janus])
m4_define([AT_PACKAGE_BUGREPORT],[bruno.turcksin@gmail.com])

AT_INIT([janus testsuite])
AT_COLOR_TESTS
AT_SETUP([TRIANGULATION polygon])
AT_DATA([geometry_pol.inp],[polygon
3
3 0. 0. 1. 0. 0. 1. 0 0
4 0. 1. 0.5 0.5 1. 2. 0. 2. 1 2 
5 1. 0. 2. 0. 2. 2. 1. 2. 0.5 0.5 2 1
])
AT_CHECK([triangulation_pol_test],[],[])
AT_CLEANUP
AT_SETUP([TRIANGULATION rectangle])
AT_DATA([geometry_rec.inp],[rectangle 
2 2
0. 1. 2.
0. 1.1 2.2
0 0 1 2
2 1 0 0
])
AT_CHECK([triangulation_rec_test],[],[])
AT_CLEANUP
AT_SETUP([PARAMETERS test 1])
AT_DATA([parameters_1.inp],[SI 1e-6 1000 4_PI 0
false  
true
false
false  
false  
glc
false
2
8
BLD
0. 0.5 10.2
most_normal 1.0
isotropic 0.3
isotropic 1.2 
most_normal 0.4
12. 11.9 10.9 10.9 9.9 9.9 9.9 1.9
12.5 11. 10. 10. 9. 9. 9. 1.
13. 10.5 9.5 9.5 8.5 8.5 8.5 0.5
])
AT_CHECK([parameters_test_1],[],[])
AT_CLEANUP
AT_SETUP([PARAMETERS test 2])
AT_DATA([parameters_2.inp],[GMRES 1e-10 270 4_PI 1
true
true
true
true
true
CG_ML
MIS
LS
true
4
4
PWLD
1.2 3.2 1.3
most_normal 10. 
reflective 
vacuum
reflective
11.5 1.
27. 2.
40.5 3.
])
AT_CHECK([parameters_test_2],[],[])
AT_CLEANUP
AT_SETUP([QUADRATURE LS])
AT_CHECK([ls_test],[],[])
AT_CLEANUP
AT_SETUP([QUADRATURE GLC])
AT_CHECK([glc_test],[],[])
AT_CLEANUP
AT_SETUP([CELL])
AT_CHECK([cell_test],[],[])
AT_CLEANUP
AT_SETUP([EDGE])
AT_CHECK([edge_test],[],[])
AT_CLEANUP
AT_SETUP([DOF HANDLER])
AT_DATA([geometry_dof.inp],[polygon
5
3 0. 0. 1. 0. 0. 1. 0 0
3 2. 0. 3. 0. 3. 1. 0 0
3 0. 2. 1. 3. 0. 3. 0 0
3 3. 2. 3. 3. 2. 3. 0 0
8 1. 0. 2. 0. 3. 1. 3. 2. 2. 3. 1. 3. 0. 2. 0. 1. 0 0
])
AT_DATA([parameters_dof.inp],[SI 1e-06 10000 4_PI 0
false
false
true
true
CG_None
GLC
true
4
4
PWLD
1.0 
vacuum
vacuum
vacuum
reflective
1.0 0.5
])
AT_DATA([cross_sections_dof.inp],[3 2 4
3. 2. 1.
3. 2. 1
4. 3. 2.
5. 4. 3.
13. 12. 11.
14. 13. 12.
15. 14. 13.
23. 22. 21.
24. 23. 22.
25. 24. 23.
103. 102. 101.
104. 103. 102.
105. 104. 103.
113. 112. 111.
114. 113. 112.
115. 114. 113.
123. 122. 121.
124. 123. 122.
125. 124. 123.
203. 202. 201.
204. 203. 202.
205. 204. 201.
213. 212. 211.
214. 213. 212.
215. 214. 213.
223. 222. 221.
224. 223. 222.
225. 224. 223. 
4. 3. 2.
4. 3. 2
5. 4. 3.
6. 5. 4.
14. 13. 12.
15. 14. 13.
16. 15. 14.
24. 23. 22.
25. 24. 23.
26. 25. 24.
104. 103. 102.
105. 104. 103.
106. 105. 104.
114. 113. 112.
115. 114. 113.
116. 115. 114.
124. 123. 122.
125. 124. 123.
126. 125. 124.
204. 203. 202.
205. 204. 203.
206. 205. 202.
214. 213. 212.
215. 214. 213.
216. 215. 214.
224. 223. 222.
225. 224. 223.
226. 225. 224. 
5. 4. 3.
5. 4. 3
6. 5. 4.
7. 6. 5.
15. 14. 13.
16. 15. 14.
17. 16. 15.
25. 24. 23.
26. 25. 24.
27. 26. 25.
105. 104. 103.
106. 105. 104.
107. 106. 105.
115. 114. 113.
116. 115. 114.
117. 116. 115.
125. 124. 123.
126. 125. 124.
127. 126. 125.
205. 204. 203.
206. 205. 204.
207. 206. 203.
215. 214. 213.
216. 215. 214.
217. 216. 215.
225. 224. 223.
226. 225. 224.
227. 226. 225.
]) 
AT_CHECK([dof_handler_test],[],[])
AT_CLEANUP
AT_SETUP([MIP])
AT_DATA([geometry_mip.inp],[
rectangle
2 2
0. 1. 2.
0. 1. 2.
0 0 0 0 
0 0 0 0 
])
AT_DATA([parameters_mip.inp],[SI 1e-06 10000 4_PI 2
false
false
false
true
CG_None
GLC
false
0
2
BLD
1.0 
vacuum
vacuum
vacuum
vacuum
1.0 0.5
])
AT_CHECK([mip_test],[],[ignore],[])
AT_CLEANUP
AT_SETUP([TRANSPORT OPERATOR: BLD ISOTROPIC AGMG])
AT_DATA([geometry_transport_1.inp],[rectangle
3 3
0. 1. 2. 3.
0. 1. 2. 3.
0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0
])
AT_DATA([parameters_transport_1.inp],[BiCGSTAB 1e-09 100 1 0
false
false
false
true
AGMG
LS
false
0
4
BLD
1.0 
vacuum
reflective
vacuum
reflective
1.0 0.5 
])
AT_CHECK([transport_operator_test_1],[],[ignore],[])
AT_CLEANUP
AT_SETUP([TRANSPORT OPERATOR: PWLD FOKKER-PLANCK ML])
AT_DATA([geometry_transport_2.inp],[polygon
5
3 0. 0. 1. 0. 0. 1. 1 0
3 2. 0. 3. 0. 3. 1. 1 0
3 0. 2. 1. 3. 0. 3. 1 0
3 3. 2. 3. 3. 2. 3. 1 0
8 1. 0. 2. 0. 3. 1. 3. 2. 2. 3. 1. 3. 0. 2. 0. 1. 0 1
])
AT_DATA([parameters_transport_2.inp],[GMRES 1e-06 10000 4_PI 0
true
true
true
true
true
CG_ML
MIS
GLC
true
8
8
PWLD
0.0 1.0 
vacuum
vacuum
vacuum
most_normal 1.0
36.0 1.0
72.0 0.5
])
AT_CHECK([transport_operator_test_2],[],[ignore],[])
AT_CLEANUP
